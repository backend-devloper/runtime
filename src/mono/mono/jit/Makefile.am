INCLUDES = 				\
	-I$(top_srcdir)			\
	$(GMODULE_CFLAGS)		\
	$(GLIB_CFLAGS)

libmono_la_LDFLAGS=-Wl,-version-script=$(srcdir)/ldscript

if X86
if PLATFORM_WIN32
export HOST_CC
endif

bin_PROGRAMS = mono
lib_LTLIBRARIES = libmono.la

libmono_la_LIBADD = 	\
	../metadata/libmonoruntime.la	\
	../metadata/libmetadata.la	\
	../io-layer/libwapi.la		\
	../utils/libmonoutils.la	\
	../os/libmonoos.la

endif

jitsources =		\
	win32-exception.c	\
	win32-exception.h	\
	codegen.h		\
	codegen-x86.c		\
	emit-x86.c		\
	regset.c		\
	debug-private.h		\
	debug.c			\
	debug-stabs.c		\
	debug-dwarf2.c		\
	debug-jit.h		\
	debug-jit.c		\
	jit.c			\
	trampoline.c		\
	exception.c		\
	linear-scan.c		\
	helpers.h		\
	helpers.c

libmono_la_SOURCES = $(jitsources)

libmonoincludedir = $(includedir)/mono/jit
libmonoinclude_HEADERS = \
	jit.h			\
	debug.h			\
	regset.h

mono_SOURCES = mono.c $(jitsources)

#mono_LDFLAGS=-static
mono_LDADD =				\
	../metadata/libmonoruntime.la	\
	../metadata/libmetadata.la	\
	../io-layer/libwapi.la		\
	../utils/libmonoutils.la	\
	../os/libmonoos.la		\
	$(GLIB_LIBS)			\
	$(GMODULE_LIBS) 		\
	-lm

mono_CFLAGS = $(AM_CFLAGS)

codegen-x86.c codegen.h: x86.brg
	../monoburg/monoburg $(srcdir)/x86.brg -d codegen.h -s codegen-x86.c

BUILT_SOURCES = codegen-x86.c codegen.h

CLEANFILES = $(BUILT_SOURCES)

EXTRA_DIST = x86.brg ldscript

